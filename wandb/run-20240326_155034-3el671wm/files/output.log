
  0%|                                                                                                                                                             | 0/248 [00:00<?, ?it/s]
memory occupied before training 1.5275530815124512
memory occupied before train_setp 1.5275530815124512
memory occupied after train_setp 1.6447405815124512
memory occupied  18.677709102630615
memory occupied  0.0
memory occupied  0.0
memory occupied  19.099756717681885
memory occupied  0.0
memory occupied  0.0
decoder out 12.0 torch.Size([4, 512, 1536]) 4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  19546 MiB |  19606 MiB |  40026 MiB |  20480 MiB |
|       from large pool |  19500 MiB |  19560 MiB |  39892 MiB |  20391 MiB |
|       from small pool |     45 MiB |     46 MiB |    133 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  19546 MiB |  19606 MiB |  40026 MiB |  20480 MiB |
|       from large pool |  19500 MiB |  19560 MiB |  39892 MiB |  20391 MiB |
|       from small pool |     45 MiB |     46 MiB |    133 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  19530 MiB |  19590 MiB |  39999 MiB |  20469 MiB |
|       from large pool |  19484 MiB |  19544 MiB |  39865 MiB |  20380 MiB |
|       from small pool |     45 MiB |     46 MiB |    133 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19878 MiB |  19904 MiB |  19904 MiB |  26624 KiB |
|       from large pool |  19832 MiB |  19856 MiB |  19856 MiB |  24576 KiB |
|       from small pool |     46 MiB |     48 MiB |     48 MiB |   2048 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339853 KiB | 673218 KiB |   8032 MiB |   7700 MiB |
|       from large pool | 339300 KiB | 672235 KiB |   7906 MiB |   7575 MiB |
|       from small pool |    553 KiB |   4577 KiB |    126 MiB |    125 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     878    |     884    |    1276    |     398    |
|       from large pool |     302    |     307    |     559    |     257    |
|       from small pool |     576    |     579    |     717    |     141    |
|---------------------------------------------------------------------------|
| Active allocs         |     878    |     884    |    1276    |     398    |
|       from large pool |     302    |     307    |     559    |     257    |
|       from small pool |     576    |     579    |     717    |     141    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     203    |     206    |     206    |       3    |
|       from large pool |     180    |     182    |     182    |       2    |
|       from small pool |      23    |      24    |      24    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     107    |     405    |     304    |
|       from large pool |      96    |     103    |     295    |     199    |
|       from small pool |       5    |      12    |     110    |     105    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
memory occupied  19.08799982070923
memory occupied  0.0
memory occupied  0.0
memory occupied  19.15831232070923
memory occupied  0.0
memory occupied  0.0
memory occupied  19.979003429412842
memory occupied  0.0
memory occupied  0.0
decoder out 24.0 torch.Size([4, 2048, 768]) 4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  20434 MiB |  20578 MiB |  41802 MiB |  21368 MiB |
|       from large pool |  20388 MiB |  20532 MiB |  41656 MiB |  21267 MiB |
|       from small pool |     45 MiB |     46 MiB |    146 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  20434 MiB |  20578 MiB |  41802 MiB |  21368 MiB |
|       from large pool |  20388 MiB |  20532 MiB |  41656 MiB |  21267 MiB |
|       from small pool |     45 MiB |     46 MiB |    146 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  20418 MiB |  20562 MiB |  41775 MiB |  21357 MiB |
|       from large pool |  20372 MiB |  20516 MiB |  41629 MiB |  21256 MiB |
|       from small pool |     45 MiB |     46 MiB |    146 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20750 MiB |  20962 MiB |  20988 MiB | 243712 KiB |
|       from large pool |  20704 MiB |  20914 MiB |  20938 MiB | 239616 KiB |
|       from small pool |     46 MiB |     48 MiB |     50 MiB |   4096 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 323148 KiB | 673218 KiB |   8139 MiB |   7823 MiB |
|       from large pool | 322916 KiB | 672235 KiB |   8000 MiB |   7685 MiB |
|       from small pool |    232 KiB |   4577 KiB |    138 MiB |    138 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     915    |     922    |    1374    |     459    |
|       from large pool |     327    |     333    |     622    |     295    |
|       from small pool |     588    |     592    |     752    |     164    |
|---------------------------------------------------------------------------|
| Active allocs         |     915    |     922    |    1374    |     459    |
|       from large pool |     327    |     333    |     622    |     295    |
|       from small pool |     588    |     592    |     752    |     164    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     226    |     235    |     238    |      12    |
|       from large pool |     203    |     211    |     213    |      10    |
|       from small pool |      23    |      24    |      25    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     107    |     430    |     330    |
|       from large pool |      96    |     103    |     301    |     205    |
|       from small pool |       4    |      12    |     129    |     125    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
memory occupied  19.955493450164795
memory occupied  0.0
memory occupied  0.0
memory occupied  20.096118450164795
memory occupied  0.0
memory occupied  0.0
memory occupied  21.87883996963501
memory occupied  0.0
memory occupied  0.0
decoder out 48.0 torch.Size([4, 8192, 384]) 4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  22355 MiB |  22645 MiB |  45920 MiB |  23564 MiB |
|       from large pool |  22308 MiB |  22598 MiB |  45759 MiB |  23450 MiB |
|       from small pool |     47 MiB |     48 MiB |    160 MiB |    113 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  22355 MiB |  22645 MiB |  45920 MiB |  23564 MiB |
|       from large pool |  22308 MiB |  22598 MiB |  45759 MiB |  23450 MiB |
|       from small pool |     47 MiB |     48 MiB |    160 MiB |    113 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  22339 MiB |  22629 MiB |  45893 MiB |  23553 MiB |
|       from large pool |  22292 MiB |  22582 MiB |  45732 MiB |  23440 MiB |
|       from small pool |     46 MiB |     47 MiB |    160 MiB |    113 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22702 MiB |  23074 MiB |  23312 MiB | 624640 KiB |
|       from large pool |  22654 MiB |  23024 MiB |  23258 MiB | 618496 KiB |
|       from small pool |     48 MiB |     50 MiB |     54 MiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 354635 KiB | 673218 KiB |   8437 MiB |   8091 MiB |
|       from large pool | 353636 KiB | 672235 KiB |   8284 MiB |   7939 MiB |
|       from small pool |    999 KiB |   4577 KiB |    153 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     952    |     959    |    1473    |     521    |
|       from large pool |     352    |     359    |     687    |     335    |
|       from small pool |     600    |     604    |     786    |     186    |
|---------------------------------------------------------------------------|
| Active allocs         |     952    |     959    |    1473    |     521    |
|       from large pool |     352    |     359    |     687    |     335    |
|       from small pool |     600    |     604    |     786    |     186    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     250    |     258    |     270    |      20    |
|       from large pool |     226    |     233    |     243    |      17    |
|       from small pool |      24    |      25    |      27    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     107    |     448    |     347    |
|       from large pool |      97    |     103    |     310    |     213    |
|       from small pool |       4    |      12    |     138    |     134    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
memory occupied  21.83171510696411
memory occupied  0.0
memory occupied  0.0
memory occupied  22.11296510696411
memory occupied  0.0
memory occupied  0.0
memory occupied  25.681328296661377
memory occupied  0.0
memory occupied  0.0
decoder out 96.0 torch.Size([4, 32768, 192]) 4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  26200 MiB |  26784 MiB |  54174 MiB |  27973 MiB |
|       from large pool |  26148 MiB |  26732 MiB |  53995 MiB |  27846 MiB |
|       from small pool |     52 MiB |     53 MiB |    179 MiB |    127 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  26200 MiB |  26784 MiB |  54174 MiB |  27973 MiB |
|       from large pool |  26148 MiB |  26732 MiB |  53995 MiB |  27846 MiB |
|       from small pool |     52 MiB |     53 MiB |    179 MiB |    127 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  26184 MiB |  26768 MiB |  54146 MiB |  27961 MiB |
|       from large pool |  26132 MiB |  26716 MiB |  53967 MiB |  27834 MiB |
|       from small pool |     51 MiB |     52 MiB |    179 MiB |    127 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  26630 MiB |  27206 MiB |  27816 MiB |   1186 MiB |
|       from large pool |  26576 MiB |  27152 MiB |  27756 MiB |   1180 MiB |
|       from small pool |     54 MiB |     54 MiB |     60 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 439626 KiB | 673218 KiB |   9042 MiB |   8613 MiB |
|       from large pool | 437604 KiB | 672235 KiB |   8871 MiB |   8444 MiB |
|       from small pool |   2022 KiB |   4577 KiB |    171 MiB |    169 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     989    |     996    |    1572    |     583    |
|       from large pool |     377    |     384    |     752    |     375    |
|       from small pool |     612    |     616    |     820    |     208    |
|---------------------------------------------------------------------------|
| Active allocs         |     989    |     996    |    1572    |     583    |
|       from large pool |     377    |     384    |     752    |     375    |
|       from small pool |     612    |     616    |     820    |     208    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     276    |     282    |     302    |      26    |
|       from large pool |     249    |     255    |     272    |      23    |
|       from small pool |      27    |      27    |      30    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     104    |     107    |     475    |     371    |
|       from large pool |      99    |     103    |     320    |     221    |
|       from small pool |       5    |      12    |     155    |     150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
memory occupied  25.586598873138428
memory occupied  0.0
memory occupied  0.0
memory occupied  25.774098873138428
memory occupied  0.0
memory occupied  0.0
memory occupied  26.196089267730713
memory occupied  0.0
  0%|                                                                                                                                                             | 0/248 [00:00<?, ?it/s]Traceback (most recent call last):
  File "main.py", line 68, in <module>
    trainer.train(config)
  File "/raid/home/rizwank/courses/DLCV/Project/train.py", line 115, in train
    loss, loss_dict = self.train_step(batch)
  File "/raid/home/rizwank/courses/DLCV/Project/train.py", line 44, in train_step
    output = self.model.module(images)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/model.py", line 228, in forward
    x = self.swin_encoder_decoder(x)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/model.py", line 124, in forward
    decoder_out, _ = self.task_decoder[task_id][i](decoder_inp)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/model.py", line 33, in forward
    out = self.model(x, output_hidden_states=True)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 1011, in forward
    encoder_outputs = self.encoder(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 836, in forward
    layer_outputs = layer_module(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 756, in forward
    layer_outputs = layer_module(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 687, in forward
    attention_outputs = self.attention(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 562, in forward
    self_outputs = self.self(hidden_states, attention_mask, head_mask, output_attentions)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 477, in forward
    attention_scores = attention_scores / math.sqrt(self.attention_head_size)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 192.00 MiB. GPU 0 has a total capacity of 31.74 GiB of which 55.38 MiB is free. Process 2991625 has 436.00 MiB memory in use. Including non-PyTorch memory, this process has 31.25 GiB memory in use. Of the allocated memory 30.24 GiB is allocated by PyTorch, and 453.68 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
decoder out 12.0 torch.Size([4, 512, 1536]) 4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  26812 MiB |  26872 MiB |  55453 MiB |  28640 MiB |
|       from large pool |  26760 MiB |  26820 MiB |  55261 MiB |  28500 MiB |
|       from small pool |     52 MiB |     53 MiB |    191 MiB |    139 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  26812 MiB |  26872 MiB |  55453 MiB |  28640 MiB |
|       from large pool |  26760 MiB |  26820 MiB |  55261 MiB |  28500 MiB |
|       from small pool |     52 MiB |     53 MiB |    191 MiB |    139 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  26796 MiB |  26856 MiB |  55425 MiB |  28628 MiB |
|       from large pool |  26744 MiB |  26804 MiB |  55233 MiB |  28488 MiB |
|       from small pool |     52 MiB |     53 MiB |    191 MiB |    139 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27172 MiB |  27206 MiB |  28370 MiB |   1198 MiB |
|       from large pool |  27118 MiB |  27152 MiB |  28310 MiB |   1192 MiB |
|       from small pool |     54 MiB |     54 MiB |     60 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 367865 KiB | 673218 KiB |   9688 MiB |   9329 MiB |
|       from large pool | 365924 KiB | 672235 KiB |   9505 MiB |   9147 MiB |
|       from small pool |   1941 KiB |   4577 KiB |    183 MiB |    181 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1026    |    1032    |    1667    |     641    |
|       from large pool |     402    |     407    |     812    |     410    |
|       from small pool |     624    |     627    |     855    |     231    |
|---------------------------------------------------------------------------|
| Active allocs         |    1026    |    1032    |    1667    |     641    |
|       from large pool |     402    |     407    |     812    |     410    |
|       from small pool |     624    |     627    |     855    |     231    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     280    |     282    |     307    |      27    |
|       from large pool |     253    |     255    |     277    |      24    |
|       from small pool |      27    |      27    |      30    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     105    |     107    |     507    |     402    |
|       from large pool |     100    |     103    |     347    |     247    |
|       from small pool |       5    |      12    |     160    |     155    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
memory occupied  26.184332370758057
memory occupied  0.0
memory occupied  0.0
memory occupied  26.254644870758057
memory occupied  0.0
memory occupied  0.0
memory occupied  27.07533597946167
memory occupied  0.0
memory occupied  0.0
decoder out 24.0 torch.Size([4, 2048, 768]) 4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  27701 MiB |  27845 MiB |  57229 MiB |  29528 MiB |
|       from large pool |  27648 MiB |  27792 MiB |  57025 MiB |  29376 MiB |
|       from small pool |     52 MiB |     53 MiB |    204 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  27701 MiB |  27845 MiB |  57229 MiB |  29528 MiB |
|       from large pool |  27648 MiB |  27792 MiB |  57025 MiB |  29376 MiB |
|       from small pool |     52 MiB |     53 MiB |    204 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  27685 MiB |  27829 MiB |  57201 MiB |  29516 MiB |
|       from large pool |  27632 MiB |  27776 MiB |  56997 MiB |  29364 MiB |
|       from small pool |     52 MiB |     53 MiB |    204 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  28044 MiB |  28230 MiB |  29428 MiB |   1384 MiB |
|       from large pool |  27990 MiB |  28176 MiB |  29368 MiB |   1378 MiB |
|       from small pool |     54 MiB |     54 MiB |     60 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 351160 KiB | 673218 KiB |   9807 MiB |   9464 MiB |
|       from large pool | 349540 KiB | 672235 KiB |   9611 MiB |   9269 MiB |
|       from small pool |   1620 KiB |   4577 KiB |    195 MiB |    194 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1063    |    1070    |    1765    |     702    |
|       from large pool |     427    |     433    |     875    |     448    |
|       from small pool |     636    |     640    |     890    |     254    |
|---------------------------------------------------------------------------|
| Active allocs         |    1063    |    1070    |    1765    |     702    |
|       from large pool |     427    |     433    |     875    |     448    |
|       from small pool |     636    |     640    |     890    |     254    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     303    |     310    |     337    |      34    |
|       from large pool |     276    |     283    |     307    |      31    |
|       from small pool |      27    |      27    |      30    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     107    |     522    |     419    |
|       from large pool |      99    |     103    |     356    |     257    |
|       from small pool |       4    |      12    |     166    |     162    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
memory occupied  27.051826000213623
memory occupied  0.0
memory occupied  0.0
memory occupied  27.192451000213623
memory occupied  0.0
memory occupied  0.0
memory occupied  28.975172519683838
memory occupied  0.0
memory occupied  0.0
decoder out 48.0 torch.Size([4, 8192, 384]) 4
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  29622 MiB |  29912 MiB |  61348 MiB |  31725 MiB |
|       from large pool |  29568 MiB |  29858 MiB |  61129 MiB |  31560 MiB |
|       from small pool |     53 MiB |     54 MiB |    218 MiB |    165 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  29622 MiB |  29912 MiB |  61348 MiB |  31725 MiB |
|       from large pool |  29568 MiB |  29858 MiB |  61129 MiB |  31560 MiB |
|       from small pool |     53 MiB |     54 MiB |    218 MiB |    165 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  29606 MiB |  29896 MiB |  61319 MiB |  31713 MiB |
|       from large pool |  29552 MiB |  29842 MiB |  61100 MiB |  31548 MiB |
|       from small pool |     53 MiB |     54 MiB |    218 MiB |    165 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29994 MiB |  30366 MiB |  31750 MiB |   1756 MiB |
|       from large pool |  29940 MiB |  30310 MiB |  31688 MiB |   1748 MiB |
|       from small pool |     54 MiB |     56 MiB |     62 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 380599 KiB | 673218 KiB |  10104 MiB |   9733 MiB |
|       from large pool | 380260 KiB | 672235 KiB |   9895 MiB |   9524 MiB |
|       from small pool |    339 KiB |   4577 KiB |    208 MiB |    208 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1100    |    1107    |    1864    |     764    |
|       from large pool |     452    |     459    |     940    |     488    |
|       from small pool |     648    |     652    |     924    |     276    |
|---------------------------------------------------------------------------|
| Active allocs         |    1100    |    1107    |    1864    |     764    |
|       from large pool |     452    |     459    |     940    |     488    |
|       from small pool |     648    |     652    |     924    |     276    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     326    |     334    |     368    |      42    |
|       from large pool |     299    |     306    |     337    |      38    |
|       from small pool |      27    |      28    |      31    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     104    |     107    |     546    |     442    |
|       from large pool |     100    |     103    |     366    |     266    |
|       from small pool |       4    |      12    |     180    |     176    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
memory occupied  28.92804765701294
memory occupied  0.0
memory occupied  0.0
memory occupied  29.20929765701294
memory occupied  0.0
memory occupied  0.0