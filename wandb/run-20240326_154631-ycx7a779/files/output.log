
  0%|                                                                                                                                                             | 0/248 [00:00<?, ?it/s]
memory occupied before training 1.5302562713623047
memory occupied before train_setp 1.5302562713623047
memory occupied after train_setp 1.6474437713623047
memory occupied  18.68041229248047
memory occupied  0.0
memory occupied  0.0
memory occupied  19.103158950805664
memory occupied  0.0
memory occupied  0.0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  19549 MiB |  19609 MiB |  40030 MiB |  20480 MiB |
|       from large pool |  19504 MiB |  19564 MiB |  39896 MiB |  20392 MiB |
|       from small pool |     45 MiB |     46 MiB |    133 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  19549 MiB |  19609 MiB |  40030 MiB |  20480 MiB |
|       from large pool |  19504 MiB |  19564 MiB |  39896 MiB |  20392 MiB |
|       from small pool |     45 MiB |     46 MiB |    133 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  19530 MiB |  19590 MiB |  39999 MiB |  20469 MiB |
|       from large pool |  19484 MiB |  19544 MiB |  39865 MiB |  20380 MiB |
|       from small pool |     45 MiB |     46 MiB |    133 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19872 MiB |  19910 MiB |  19910 MiB |  38912 KiB |
|       from large pool |  19826 MiB |  19862 MiB |  19862 MiB |  36864 KiB |
|       from small pool |     46 MiB |     48 MiB |     48 MiB |   2048 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 330142 KiB | 676528 KiB |   7473 MiB |   7150 MiB |
|       from large pool | 329589 KiB | 675545 KiB |   7346 MiB |   7025 MiB |
|       from small pool |    553 KiB |   4577 KiB |    126 MiB |    125 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     878    |     884    |    1276    |     398    |
|       from large pool |     302    |     307    |     559    |     257    |
|       from small pool |     576    |     579    |     717    |     141    |
|---------------------------------------------------------------------------|
| Active allocs         |     878    |     884    |    1276    |     398    |
|       from large pool |     302    |     307    |     559    |     257    |
|       from small pool |     576    |     579    |     717    |     141    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     210    |     214    |     214    |       4    |
|       from large pool |     187    |     190    |     190    |       3    |
|       from small pool |      23    |      24    |      24    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     108    |     396    |     294    |
|       from large pool |      97    |     104    |     286    |     189    |
|       from small pool |       5    |      12    |     110    |     105    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
decoder out 12.0 torch.Size([4, 512, 1536]) 4
memory occupied  19.091402053833008
memory occupied  0.0
memory occupied  0.0
memory occupied  19.161714553833008
memory occupied  0.0
memory occupied  0.0
memory occupied  19.98240566253662
memory occupied  0.0
memory occupied  0.0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  20437 MiB |  20582 MiB |  41806 MiB |  21369 MiB |
|       from large pool |  20392 MiB |  20536 MiB |  41660 MiB |  21268 MiB |
|       from small pool |     45 MiB |     46 MiB |    146 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  20437 MiB |  20582 MiB |  41806 MiB |  21369 MiB |
|       from large pool |  20392 MiB |  20536 MiB |  41660 MiB |  21268 MiB |
|       from small pool |     45 MiB |     46 MiB |    146 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  20418 MiB |  20562 MiB |  41775 MiB |  21357 MiB |
|       from large pool |  20372 MiB |  20516 MiB |  41629 MiB |  21256 MiB |
|       from small pool |     45 MiB |     46 MiB |    146 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20744 MiB |  20956 MiB |  20994 MiB | 256000 KiB |
|       from large pool |  20698 MiB |  20908 MiB |  20944 MiB | 251904 KiB |
|       from small pool |     46 MiB |     48 MiB |     50 MiB |   4096 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 313437 KiB | 676528 KiB |   7567 MiB |   7261 MiB |
|       from large pool | 313205 KiB | 675545 KiB |   7428 MiB |   7123 MiB |
|       from small pool |    232 KiB |   4577 KiB |    138 MiB |    138 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     915    |     922    |    1374    |     459    |
|       from large pool |     327    |     333    |     622    |     295    |
|       from small pool |     588    |     592    |     752    |     164    |
|---------------------------------------------------------------------------|
| Active allocs         |     915    |     922    |    1374    |     459    |
|       from large pool |     327    |     333    |     622    |     295    |
|       from small pool |     588    |     592    |     752    |     164    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     233    |     242    |     246    |      13    |
|       from large pool |     210    |     218    |     221    |      11    |
|       from small pool |      23    |      24    |      25    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     108    |     423    |     322    |
|       from large pool |      97    |     104    |     294    |     197    |
|       from small pool |       4    |      12    |     129    |     125    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
decoder out 24.0 torch.Size([4, 2048, 768]) 4
memory occupied  19.958895683288574
memory occupied  0.0
memory occupied  0.0
memory occupied  20.099520683288574
memory occupied  0.0
memory occupied  0.0
memory occupied  21.88224220275879
memory occupied  0.0
memory occupied  0.0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  22359 MiB |  22649 MiB |  45925 MiB |  23566 MiB |
|       from large pool |  22312 MiB |  22602 MiB |  45764 MiB |  23452 MiB |
|       from small pool |     47 MiB |     48 MiB |    160 MiB |    113 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  22359 MiB |  22649 MiB |  45925 MiB |  23566 MiB |
|       from large pool |  22312 MiB |  22602 MiB |  45764 MiB |  23452 MiB |
|       from small pool |     47 MiB |     48 MiB |    160 MiB |    113 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  22339 MiB |  22629 MiB |  45893 MiB |  23553 MiB |
|       from large pool |  22292 MiB |  22582 MiB |  45732 MiB |  23440 MiB |
|       from small pool |     46 MiB |     47 MiB |    160 MiB |    113 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  22696 MiB |  23068 MiB |  23318 MiB | 636928 KiB |
|       from large pool |  22648 MiB |  23018 MiB |  23264 MiB | 630784 KiB |
|       from small pool |     48 MiB |     50 MiB |     54 MiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 344924 KiB | 676528 KiB |   7866 MiB |   7530 MiB |
|       from large pool | 343925 KiB | 675545 KiB |   7713 MiB |   7377 MiB |
|       from small pool |    999 KiB |   4577 KiB |    153 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     952    |     959    |    1473    |     521    |
|       from large pool |     352    |     359    |     687    |     335    |
|       from small pool |     600    |     604    |     786    |     186    |
|---------------------------------------------------------------------------|
| Active allocs         |     952    |     959    |    1473    |     521    |
|       from large pool |     352    |     359    |     687    |     335    |
|       from small pool |     600    |     604    |     786    |     186    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     257    |     265    |     278    |      21    |
|       from large pool |     233    |     240    |     251    |      18    |
|       from small pool |      24    |      25    |      27    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     108    |     443    |     341    |
|       from large pool |      98    |     104    |     305    |     207    |
|       from small pool |       4    |      12    |     138    |     134    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
decoder out 48.0 torch.Size([4, 8192, 384]) 4
memory occupied  21.83511734008789
memory occupied  0.0
memory occupied  0.0
memory occupied  22.11636734008789
memory occupied  0.0
memory occupied  0.0
memory occupied  25.684730529785156
memory occupied  0.0
memory occupied  0.0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  26204 MiB |  26788 MiB |  54179 MiB |  27975 MiB |
|       from large pool |  26152 MiB |  26736 MiB |  54000 MiB |  27847 MiB |
|       from small pool |     52 MiB |     53 MiB |    179 MiB |    127 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  26204 MiB |  26788 MiB |  54179 MiB |  27975 MiB |
|       from large pool |  26152 MiB |  26736 MiB |  54000 MiB |  27847 MiB |
|       from small pool |     52 MiB |     53 MiB |    179 MiB |    127 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  26184 MiB |  26768 MiB |  54146 MiB |  27961 MiB |
|       from large pool |  26132 MiB |  26716 MiB |  53967 MiB |  27834 MiB |
|       from small pool |     51 MiB |     52 MiB |    179 MiB |    127 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  26624 MiB |  27200 MiB |  27822 MiB |   1198 MiB |
|       from large pool |  26570 MiB |  27146 MiB |  27762 MiB |   1192 MiB |
|       from small pool |     54 MiB |     54 MiB |     60 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 429915 KiB | 676528 KiB |   8471 MiB |   8051 MiB |
|       from large pool | 427893 KiB | 675545 KiB |   8300 MiB |   7882 MiB |
|       from small pool |   2022 KiB |   4577 KiB |    171 MiB |    169 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     989    |     996    |    1572    |     583    |
|       from large pool |     377    |     384    |     752    |     375    |
|       from small pool |     612    |     616    |     820    |     208    |
|---------------------------------------------------------------------------|
| Active allocs         |     989    |     996    |    1572    |     583    |
|       from large pool |     377    |     384    |     752    |     375    |
|       from small pool |     612    |     616    |     820    |     208    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     283    |     289    |     310    |      27    |
|       from large pool |     256    |     262    |     280    |      24    |
|       from small pool |      27    |      27    |      30    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     105    |     108    |     470    |     365    |
|       from large pool |     100    |     104    |     315    |     215    |
|       from small pool |       5    |      12    |     155    |     150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
decoder out 96.0 torch.Size([4, 32768, 192]) 4
memory occupied  25.590001106262207
memory occupied  0.0
memory occupied  0.0
memory occupied  25.777501106262207
memory occupied  0.0
memory occupied  0.0
memory occupied  26.199491500854492
memory occupied  0.0
memory occupied  0.0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  26816 MiB |  26876 MiB |  55458 MiB |  28641 MiB |
|       from large pool |  26764 MiB |  26824 MiB |  55266 MiB |  28502 MiB |
|       from small pool |     52 MiB |     53 MiB |    191 MiB |    139 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  26816 MiB |  26876 MiB |  55458 MiB |  28641 MiB |
|       from large pool |  26764 MiB |  26824 MiB |  55266 MiB |  28502 MiB |
|       from small pool |     52 MiB |     53 MiB |    191 MiB |    139 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  26796 MiB |  26856 MiB |  55425 MiB |  28628 MiB |
|       from large pool |  26744 MiB |  26804 MiB |  55233 MiB |  28488 MiB |
|       from small pool |     52 MiB |     53 MiB |    191 MiB |    139 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  27202 MiB |  27202 MiB |  28400 MiB |   1198 MiB |
|       from large pool |  27148 MiB |  27148 MiB |  28340 MiB |   1192 MiB |
|       from small pool |     54 MiB |     54 MiB |     60 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 395018 KiB | 676528 KiB |   9130 MiB |   8744 MiB |
|       from large pool | 393077 KiB | 675545 KiB |   8946 MiB |   8562 MiB |
|       from small pool |   1941 KiB |   4577 KiB |    183 MiB |    181 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1026    |    1032    |    1667    |     641    |
|       from large pool |     402    |     407    |     812    |     410    |
|       from small pool |     624    |     627    |     855    |     231    |
|---------------------------------------------------------------------------|
| Active allocs         |    1026    |    1032    |    1667    |     641    |
|       from large pool |     402    |     407    |     812    |     410    |
|       from small pool |     624    |     627    |     855    |     231    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     287    |     289    |     314    |      27    |
|       from large pool |     260    |     262    |     284    |      24    |
|       from small pool |      27    |      27    |      30    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     108    |     109    |     504    |     396    |
|       from large pool |     103    |     104    |     344    |     241    |
|       from small pool |       5    |      12    |     160    |     155    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
decoder out 12.0 torch.Size([4, 512, 1536]) 4
memory occupied  26.187734603881836
memory occupied  0.0
memory occupied  0.0
memory occupied  26.258047103881836
memory occupied  0.0
memory occupied  0.0
memory occupied  27.07873821258545
memory occupied  0.0
memory occupied  0.0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  27704 MiB |  27848 MiB |  57234 MiB |  29530 MiB |
|       from large pool |  27652 MiB |  27796 MiB |  57030 MiB |  29378 MiB |
|       from small pool |     52 MiB |     53 MiB |    204 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  27704 MiB |  27848 MiB |  57234 MiB |  29530 MiB |
|       from large pool |  27652 MiB |  27796 MiB |  57030 MiB |  29378 MiB |
|       from small pool |     52 MiB |     53 MiB |    204 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  27685 MiB |  27829 MiB |  57201 MiB |  29516 MiB |
|       from large pool |  27632 MiB |  27776 MiB |  56997 MiB |  29364 MiB |
|       from small pool |     52 MiB |     53 MiB |    204 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  28074 MiB |  28266 MiB |  29464 MiB |   1390 MiB |
|       from large pool |  28020 MiB |  28212 MiB |  29404 MiB |   1384 MiB |
|       from small pool |     54 MiB |     54 MiB |     60 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 378313 KiB | 676528 KiB |   9254 MiB |   8884 MiB |
|       from large pool | 376693 KiB | 675545 KiB |   9058 MiB |   8690 MiB |
|       from small pool |   1620 KiB |   4577 KiB |    195 MiB |    194 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1063    |    1070    |    1765    |     702    |
|       from large pool |     427    |     433    |     875    |     448    |
|       from small pool |     636    |     640    |     890    |     254    |
|---------------------------------------------------------------------------|
| Active allocs         |    1063    |    1070    |    1765    |     702    |
|       from large pool |     427    |     433    |     875    |     448    |
|       from small pool |     636    |     640    |     890    |     254    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     310    |     317    |     344    |      34    |
|       from large pool |     283    |     290    |     314    |      31    |
|       from small pool |      27    |      27    |      30    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     106    |     109    |     519    |     413    |
|       from large pool |     102    |     104    |     353    |     251    |
|       from small pool |       4    |      12    |     166    |     162    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
decoder out 24.0 torch.Size([4, 2048, 768]) 4
memory occupied  27.055228233337402
memory occupied  0.0
memory occupied  0.0
memory occupied  27.195853233337402
memory occupied  0.0
memory occupied  0.0
memory occupied  28.978574752807617
memory occupied  0.0
memory occupied  0.0
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  29625 MiB |  29915 MiB |  61353 MiB |  31727 MiB |
|       from large pool |  29572 MiB |  29862 MiB |  61134 MiB |  31562 MiB |
|       from small pool |     53 MiB |     54 MiB |    218 MiB |    165 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  29625 MiB |  29915 MiB |  61353 MiB |  31727 MiB |
|       from large pool |  29572 MiB |  29862 MiB |  61134 MiB |  31562 MiB |
|       from small pool |     53 MiB |     54 MiB |    218 MiB |    165 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  29606 MiB |  29896 MiB |  61319 MiB |  31713 MiB |
|       from large pool |  29552 MiB |  29842 MiB |  61100 MiB |  31548 MiB |
|       from small pool |     53 MiB |     54 MiB |    218 MiB |    165 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  30024 MiB |  30396 MiB |  31786 MiB |   1762 MiB |
|       from large pool |  29970 MiB |  30340 MiB |  31724 MiB |   1754 MiB |
|       from small pool |     54 MiB |     56 MiB |     62 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 407752 KiB | 676528 KiB |   9552 MiB |   9153 MiB |
|       from large pool | 407413 KiB | 675545 KiB |   9343 MiB |   8945 MiB |
|       from small pool |    339 KiB |   4577 KiB |    208 MiB |    208 MiB |
|---------------------------------------------------------------------------|
| Allocations           |    1100    |    1107    |    1864    |     764    |
|       from large pool |     452    |     459    |     940    |     488    |
|       from small pool |     648    |     652    |     924    |     276    |
|---------------------------------------------------------------------------|
| Active allocs         |    1100    |    1107    |    1864    |     764    |
|       from large pool |     452    |     459    |     940    |     488    |
|       from small pool |     648    |     652    |     924    |     276    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     333    |     341    |     375    |      42    |
|       from large pool |     306    |     313    |     344    |      38    |
|       from small pool |      27    |      28    |      31    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     107    |     109    |     544    |     437    |
|       from large pool |     103    |     104    |     364    |     261    |
|       from small pool |       4    |      12    |     180    |     176    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
decoder out 48.0 torch.Size([4, 8192, 384]) 4
memory occupied  28.93144989013672
memory occupied  0.0
memory occupied  0.0
memory occupied  29.21269989013672
memory occupied  0.0
  0%|                                                                                                                                                             | 0/248 [00:00<?, ?it/s]Traceback (most recent call last):
  File "main.py", line 68, in <module>
    trainer.train(config)
  File "/raid/home/rizwank/courses/DLCV/Project/train.py", line 115, in train
    loss, loss_dict = self.train_step(batch)
  File "/raid/home/rizwank/courses/DLCV/Project/train.py", line 44, in train_step
    output = self.model.module(images)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/model.py", line 225, in forward
    x = self.swin_encoder_decoder(x)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/model.py", line 123, in forward
    decoder_out, _ = self.task_decoder[task_id][i](decoder_inp)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/model.py", line 32, in forward
    out = self.model(x, output_hidden_states=True)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 1011, in forward
    encoder_outputs = self.encoder(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 836, in forward
    layer_outputs = layer_module(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 756, in forward
    layer_outputs = layer_module(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 687, in forward
    attention_outputs = self.attention(
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 562, in forward
    self_outputs = self.self(hidden_states, attention_mask, head_mask, output_attentions)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/rizwank/courses/DLCV/Project/transformers/src/transformers/models/swin/modeling_swin.py", line 477, in forward
    attention_scores = attention_scores / math.sqrt(self.attention_head_size)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 192.00 MiB. GPU 0 has a total capacity of 31.74 GiB of which 25.38 MiB is free. Process 2991625 has 436.00 MiB memory in use. Including non-PyTorch memory, this process has 31.28 GiB memory in use. Of the allocated memory 30.25 GiB is allocated by PyTorch, and 480.20 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)